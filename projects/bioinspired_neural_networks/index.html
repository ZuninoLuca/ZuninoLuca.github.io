<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Bio-Inspired Neural Networks for OMR &amp; Rheotaxis | Luca Zunino </title> <meta name="author" content="Luca Zunino"> <meta name="description" content="EPFL Master’s thesis"> <meta name="keywords" content="luca, zunino, luca-zunino, machine-learning, robotics, research, engineer, portfolio"> <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"> <meta http-equiv="Pragma" content="no-cache"> <meta http-equiv="Expires" content="0"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A4%96&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://zuninoluca.github.io/projects/bioinspired_neural_networks/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Luca</span> Zunino </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Bio-Inspired Neural Networks for OMR &amp; Rheotaxis</h1> <p class="post-description">EPFL Master’s thesis</p> </header> <article> <h2 id="at-a-glance">At a glance</h2> <p>This thesis explores how <strong>bio-inspired artificial neural networks</strong> can be used to improve the behavior of a neuromechanical zebrafish simulation (<strong>simZFish</strong>), with a focus on two tightly coupled behaviors:</p> <ul> <li> <strong>Optomotor Response (OMR):</strong> visually-evoked turning and forward swimming that stabilizes position relative to moving visual scenes.</li> <li> <strong>Rheotaxis:</strong> station-keeping in flowing water (tendency to orient and swim against the current).</li> </ul> <p>The starting point is simZFish, a highly realistic and biologically grounded control architecture, but one that relies heavily on <strong>hand-tuning</strong> many neural parameters. This work proposes learning-based alternatives that preserve <em>biological structure</em> while drastically improving scalability, reproducibility, and adaptability.</p> <div class="row justify-content-center"> <div class="col-sm-6 mx-auto mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/project_covers/simzfish-480.webp 480w,/assets/img/project_covers/simzfish-800.webp 800w,/assets/img/project_covers/simzfish-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/project_covers/simzfish.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Training ground for simZFish" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Training ground for simZFish: a Webots simulation of a flowing river where our reinforcement learning framework teaches neural controllers to navigate complex fluid dynamics. This approach bridges the gap between biological realism and learned adaptability. </div> <hr> <h2 id="why-this-matters-from-hand-tuned-circuits-to-scalable-discovery-tools">Why this matters: From “hand-tuned circuits” to scalable discovery tools</h2> <p>Hand-tuned neural circuits can reproduce animal behavior with impressive fidelity, but they come with practical limitations:</p> <ul> <li>Tuning is <strong>time-consuming</strong> and becomes impractical as networks grow;</li> <li>It is hard to explore hypotheses that require <strong>systematic parameter sweeps</strong>;</li> <li>Not all neuron activations are available from biology, which introduces arbitrariness.</li> </ul> <p>This thesis treats simZFish as an experimental platform where we can:</p> <p>1) Keep the <strong>biological interpretability</strong> of structured circuits, while<br> 2) Introducing learning frameworks that can <strong>fill unknown gaps</strong> and <strong>optimize behavior</strong> under controlled conditions.</p> <hr> <h2 id="the-platform-simzfish-as-an-embodied-brainbodyenvironment-system">The platform: simZFish as an embodied brain–body–environment system</h2> <p>SimZFish integrates a complete chain from perception to actuation:</p> <ul> <li> <strong>Visual sensing</strong> (camera-based retina model),</li> <li> <strong>Motion-direction processing</strong> (direction-selective stages),</li> <li> <strong>Pretectal and hindbrain representations</strong> that separate turning/forward commands,</li> <li> <strong>Central Pattern Generators (CPGs)</strong> and motor pathways to drive tail motion,</li> <li> <strong>Embodiment and hydrodynamics</strong> in a river-like environment.</li> </ul> <p>This matters because OMR and rheotaxis are not “outputs of a controller” only, but emerge from the interaction of <strong>neural dynamics + body mechanics + environment</strong>.</p> <hr> <h2 id="two-complementary-learning-routes">Two complementary learning routes</h2> <h3 id="1-supervised-learning-learn-bio-inspired-networks-from-activation-targets">1) Supervised learning: learn bio-inspired networks from activation targets</h3> <p>The supervised-learning framework focuses on learning a <em>specific</em> sub-circuit that maps pretectal activity to motor-command neurons:</p> <ul> <li> <strong>Input:</strong> early pretectum (ePT) neurons</li> <li> <strong>Hidden:</strong> late pretectum (lPT) neurons</li> <li> <strong>Output:</strong> nMLF and aHB neurons (brainstem / motor-command related)</li> </ul> <p>Two architectures are trained to mirror two hand-designed variants:</p> <ul> <li> <strong>Model 1:</strong> 8 → 16 → 4 (corresponding to simZFish 1.0)</li> <li> <strong>Model 2:</strong> 8 → 24 → 4 (corresponding to simZFish 2.0)</li> </ul> <div class="row justify-content-center"> <div class="col-sm-10 mx-auto mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/thesis/Architecture_2-480.webp 480w,/assets/img/projects/thesis/Architecture_2-800.webp 800w,/assets/img/projects/thesis/Architecture_2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/thesis/Architecture_2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Architecture of Model 2 (simZFish 2.0)." loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Architecture of Model 2 (corresponding to simZFish 2.0). This bio-inspired network is a multi-layer perceptron with a single hidden layer, and is composed of eight input neurons, twenty-four hidden neurons and four output neurons. </div> <p>Training data are generated by presenting diverse moving-stripe stimuli and collecting input/output activations from a reference controller. Two training strategies are considered:</p> <ul> <li> <strong>Output supervision only:</strong> constrain the output neurons.</li> <li> <strong>Hidden + output supervision:</strong> additionally constrain hidden-layer activations (stronger biological anchoring).</li> </ul> <div class="row justify-content-center"> <div class="col-sm-10 mx-auto mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/thesis/Training_2-480.webp 480w,/assets/img/projects/thesis/Training_2-800.webp 800w,/assets/img/projects/thesis/Training_2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/thesis/Training_2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Graph representing the values of the weights of Model 2 (simZFish 2.0) after training." loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Graph representing the values of the weights of Model 2 (simZFish 2.0) after the training process with hidden layer supervision. The positive weights are represented in red, the negative weights in blue. The thickness of each weight represents its magnitude. </div> <p><strong>Main takeaway:</strong> supervised learning can reproduce target activations very accurately and produces stable solutions, but it cannot truly “beat” the reference if the dataset itself is derived from that reference (it tends to approximate what it was trained on).</p> <hr> <h3 id="2-reinforcement-learning-optimize-behavior-directly-with-modular-priors">2) Reinforcement learning: optimize behavior directly (with modular priors)</h3> <p>The reinforcement-learning framework is designed to be <strong>modular</strong>: the user can vary what the agent “knows” (observation space) and what it can control (action space), which directly corresponds to injecting different degrees of biological realism.</p> <p><strong>Algorithms:</strong> PPO and SAC (implemented in a Webots-based training loop).</p> <p><strong>Observation spaces (examples):</strong></p> <ul> <li> <strong>Idealized baseline:</strong> position, heading, velocity (easy but less biological)</li> <li> <strong>Biologically grounded:</strong> direction-selective (DS) signals in early pretectum (harder but closer to sensorimotor processing)</li> </ul> <p><strong>Action spaces (examples):</strong></p> <ul> <li>Bias/drive motor-command pathways (e.g., nMLF/aHB-like control signals)</li> <li>Adjust <strong>CPG parameters</strong> to modulate gaits</li> <li>Directly control tail motors (a more fine-grained but harder control problem)</li> </ul> <p><strong>Reward shaping:</strong> encourages station-keeping (stay near a target position) and alignment against flow (stable upstream heading), with smooth penalties to support learning.</p> <p><strong>Main takeaway:</strong> RL can produce controllers that achieve <em>more convincing</em> rheotaxis/OMR behaviors than hand-tuned baselines. Furthermore, it can generalize across flow conditions, especially when the action space allows fine motor control and the observations provide sufficient state information.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/thesis/OMR_Hand-480.webp 480w,/assets/img/projects/thesis/OMR_Hand-800.webp 800w,/assets/img/projects/thesis/OMR_Hand-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/thesis/OMR_Hand.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="OMR in a flowing river of the hand-tuned simZFish 2.0" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/thesis/OMR_RL-480.webp 480w,/assets/img/projects/thesis/OMR_RL-800.webp 800w,/assets/img/projects/thesis/OMR_RL-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/thesis/OMR_RL.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="OMR in a flowing river of the Reinforcement Learning controller" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Forward optomotor response (OMR) under different flow speeds. The OMR is a visually driven behavior that helps the fish swim to compensate for motion in its surroundings. Here we test station keeping in a flowing river: better controllers keep the longitudinal position close to zero (less drift). Left (hand-tuned simZFish 2.0): larger displacements indicate weaker compensation. Right (Reinforcement Learning controller): the SAC-trained controller (observation space: position/velocity; action space: delta motors) reduces drift, resulting in more stable behavior across flow speeds. </div> <hr> <h2 id="experimental-evaluation-omr--rheotaxis-in-a-simulated-river">Experimental evaluation: OMR + rheotaxis in a simulated river</h2> <p>To validate learned networks behaviorally (not just neuron-wise), the thesis defines a river-based evaluation suite inspired by prior simZFish experiments:</p> <ol> <li> <strong>Turning OMR:</strong> initialize the fish with different headings and measure whether it turns to align appropriately.</li> <li> <strong>Turning OMR (multi-trial):</strong> repeat for two headings across multiple trials to assess robustness.</li> <li> <strong>Forward OMR + rheotaxis (varying flow):</strong> initialize upstream and test station-keeping under different water speeds.</li> <li> <strong>Forward OMR + rheotaxis (multi-trial):</strong> robustness under repeated trials at a fixed flow.</li> </ol> <p>These experiments allow controlled comparisons between:</p> <ul> <li>Hand-tuned controllers,</li> <li>Supervised-trained controllers (activation-matching),</li> <li>RL-trained controllers (behavior-optimized).</li> </ul> <hr> <h2 id="key-outcomes-and-lessons-learned">Key outcomes and lessons learned</h2> <ul> <li> <strong>Supervised learning</strong> is excellent for reproducing <em>known</em> activation patterns and for building interpretable, biologically constrained surrogates. However, its ceiling is limited by the dataset source.</li> <li> <strong>Reinforcement learning</strong> is the most powerful tool for <em>behavioral optimization</em> because it avoids requiring labeled neural activation datasets and can adapt to new conditions.</li> <li> <strong>Modularity matters:</strong> swapping observation/action spaces provides a principled way to encode biological assumptions and ask “what minimal signals/control pathways are sufficient for the behavior?”</li> <li> <strong>Practical insight:</strong> baseline rhythmicity (CPGs) can dramatically simplify learning when sensory signals do not directly reveal global state, while direct motor control can be superior when state information is explicit.</li> </ul> <hr> <h2 id="acknowledgements">Acknowledgements</h2> <p>Source of all images: “Enhancing Robotic Behavior through Bio-Inspired Artificial Neural Networks: A Study of Optomotor Response and Rheotaxis in Robotic Fish”, Luca Zunino</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Luca Zunino. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>